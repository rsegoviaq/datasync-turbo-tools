# DataSync Turbo Tools - Production Configuration
# Complete production configuration with monitoring and error handling

# ============================================================================
# AWS SETTINGS
# ============================================================================

# AWS Profile (recommended: use dedicated profile for production)
export AWS_PROFILE="production"

# AWS Region
export AWS_REGION="us-east-1"

# ============================================================================
# S3 SETTINGS
# ============================================================================

# S3 Bucket Name (REQUIRED)
export BUCKET_NAME="production-data-bucket"

# S3 Subdirectory/Prefix
export S3_SUBDIRECTORY="datasync/uploads"

# Storage Class
# Options: STANDARD | STANDARD_IA | INTELLIGENT_TIERING | GLACIER | DEEP_ARCHIVE
export S3_STORAGE_CLASS="INTELLIGENT_TIERING"

# ============================================================================
# SOURCE SETTINGS
# ============================================================================

# Source directory to upload (REQUIRED)
export SOURCE_DIR="/data/production/uploads"

# ============================================================================
# S5CMD PERFORMANCE SETTINGS (Optimized for 3+ Gbps networks)
# ============================================================================

# Number of concurrent operations (64 recommended for high-bandwidth)
export S5CMD_CONCURRENCY="64"

# Multipart upload chunk size (larger = better for big files)
export S5CMD_PART_SIZE="128MB"

# Number of worker goroutines (32 recommended for high-performance)
export S5CMD_NUM_WORKERS="32"

# Retry count for failed uploads
export S5CMD_RETRY_COUNT="5"

# Log level (info recommended for production)
export S5CMD_LOG_LEVEL="info"

# Checksum algorithm
# CRC64NVME: Faster, hardware-accelerated
# SHA256: Better for compliance requirements
export S5CMD_CHECKSUM_ALGORITHM="CRC64NVME"

# ============================================================================
# LOGGING (Production-grade)
# ============================================================================

# Enable logging to file
export ENABLE_LOGGING="true"

# Log directory (ensure sufficient disk space)
export LOG_DIR="/var/log/datasync-turbo"

# Log retention days (managed by logrotate)
export LOG_RETENTION_DAYS="30"

# Enable JSON output for log aggregation
export ENABLE_JSON_OUTPUT="true"

# JSON output directory
export JSON_OUTPUT_DIR="/var/log/datasync-turbo/json"

# ============================================================================
# MONITORING & ALERTING
# ============================================================================

# Enable health checks
export ENABLE_HEALTH_CHECK="true"

# Health check file (updated after each successful sync)
export HEALTH_CHECK_FILE="/var/run/datasync-turbo/last-sync"

# Minimum throughput threshold (MB/s) - alert if below this
export MIN_THROUGHPUT_MBPS="500"

# Maximum acceptable sync time (seconds) - alert if exceeded
export MAX_SYNC_TIME="600"

# Alert webhook URL (optional - for Slack/Discord/etc)
export ALERT_WEBHOOK_URL=""

# Alert email (optional - requires sendmail or similar)
export ALERT_EMAIL=""

# ============================================================================
# ERROR HANDLING
# ============================================================================

# Enable automatic retry on failure
export ENABLE_AUTO_RETRY="true"

# Max retry attempts
export MAX_RETRY_ATTEMPTS="3"

# Retry delay (seconds)
export RETRY_DELAY="60"

# Enable rollback on critical failure
export ENABLE_ROLLBACK="false"

# ============================================================================
# SECURITY
# ============================================================================

# Enable checksum verification (strongly recommended)
export ENABLE_CHECKSUM_VERIFICATION="true"

# Server-side encryption
# Options: AES256 | aws:kms
export S3_SERVER_SIDE_ENCRYPTION="aws:kms"

# KMS Key ID (required if using aws:kms)
export S3_KMS_KEY_ID=""

# Enable versioning check (ensure bucket versioning is enabled)
export CHECK_BUCKET_VERSIONING="true"

# ============================================================================
# PERFORMANCE MONITORING
# ============================================================================

# Enable performance metrics collection
export ENABLE_PERFORMANCE_METRICS="true"

# Metrics output file
export METRICS_FILE="/var/log/datasync-turbo/metrics.json"

# Enable CloudWatch metrics (requires AWS CLI and permissions)
export ENABLE_CLOUDWATCH_METRICS="false"

# CloudWatch namespace
export CLOUDWATCH_NAMESPACE="DataSync/Turbo"

# ============================================================================
# MAINTENANCE
# ============================================================================

# Enable cleanup of old local files after successful upload
export ENABLE_CLEANUP="false"

# Cleanup age (days) - only applies if ENABLE_CLEANUP=true
export CLEANUP_AGE_DAYS="7"

# Enable disk space check before upload
export CHECK_DISK_SPACE="true"

# Minimum free disk space (GB) required to proceed
export MIN_FREE_DISK_SPACE_GB="10"

# ============================================================================
# NOTIFICATIONS
# ============================================================================

# Enable success notifications
export NOTIFY_ON_SUCCESS="true"

# Enable failure notifications
export NOTIFY_ON_FAILURE="true"

# Notification method: log|email|webhook|all
export NOTIFICATION_METHOD="log"

# ============================================================================
# PRODUCTION CHECKLIST
# ============================================================================
#
# Before deploying to production:
#
# 1. [_] Verify AWS credentials and permissions
# 2. [_] Test S3 bucket access with write permissions
# 3. [_] Ensure log directory exists and is writable
# 4. [_] Configure log rotation (see logging/log-rotation.conf)
# 5. [_] Set up monitoring alerts (see monitoring/)
# 6. [_] Test upload with --dry-run first
# 7. [_] Run benchmark to verify network performance
# 8. [_] Configure backup retention policies
# 9. [_] Document rollback procedures
# 10. [_] Set up CloudWatch alarms (optional)
#
# ============================================================================
