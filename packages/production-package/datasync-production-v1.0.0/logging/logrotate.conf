# DataSync Turbo Tools - Log Rotation Configuration
# Place this file in /etc/logrotate.d/datasync-turbo
#
# Installation:
#   sudo cp logging/log-rotation.conf /etc/logrotate.d/datasync-turbo
#   sudo chmod 644 /etc/logrotate.d/datasync-turbo
#
# Test configuration:
#   sudo logrotate -d /etc/logrotate.d/datasync-turbo
#
# Force rotation (for testing):
#   sudo logrotate -f /etc/logrotate.d/datasync-turbo

/var/log/datasync-turbo/*.log {
    # Rotate daily
    daily

    # Keep 30 days of logs
    rotate 30

    # Compress old logs
    compress

    # Delay compression until next rotation
    delaycompress

    # Don't error if log file is missing
    missingok

    # Don't rotate if log is empty
    notifempty

    # Create new log file with these permissions
    create 0644 root root

    # Use date as extension (e.g., datasync-20250123.log.gz)
    dateext
    dateformat -%Y%m%d

    # Append date after filename (not before extension)
    extension .log

    # Run this script after rotation
    postrotate
        # Reload any services if needed
        # systemctl reload datasync-turbo 2>/dev/null || true
    endscript
}

/var/log/datasync-turbo/json/*.json {
    # Rotate weekly for JSON files
    weekly

    # Keep 12 weeks of JSON logs
    rotate 12

    # Compress
    compress
    delaycompress

    # Don't error if missing
    missingok
    notifempty

    # Create new file
    create 0644 root root

    # Use date extension
    dateext
    dateformat -%Y%m%d
    extension .json
}

/var/log/datasync-turbo/alerts.log {
    # Rotate weekly
    weekly

    # Keep 52 weeks (1 year) of alerts
    rotate 52

    # Compress
    compress
    delaycompress

    # Always keep file
    missingok

    # Create new file
    create 0644 root root

    # Use date extension
    dateext
    dateformat -%Y%m%d
}

# Advanced options (uncomment if needed)
#
# Size-based rotation (instead of time-based)
# size 100M
#
# Rotate if older than 30 days
# maxage 30
#
# Shred logs before deletion (for sensitive data)
# shred
# shredcycles 3
#
# Email logs before deletion
# mail admin@example.com
# mailfirst
#
# Copy instead of rename (useful for active files)
# copy
# copytruncate
